<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>CTO Lecture Series - SQL 101 - 6 Joining Data</title>

    <link rel="stylesheet" href="../../css/reveal.css">
    <link rel="stylesheet" href="../../css/theme/teal.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="../../lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section>
            <h1>CTO Lecture Series</h1>
            <h2>SQL 101</h2>
            <p class="author">
                <small>Created by <a href="http://twitter.com/_jim87">James Robinson</a> for <a
                        href="http://www.openhamilton.com">Hamilton Re</a></small>
            </p>
        </section>
        <section id="recap">
            <section>
                <h1>Recap</h1>
                <ul>
                    <li class="fragment">Last time we learned how to a bunch of small things.</li>
                    <li class="fragment">We learned how to order results.</li>
                    <li class="fragment">We learned how to stick results together vertically.</li>
                    <li class="fragment">We learned how to do use case statements.</li>
                </ul>
            </section>
            <section>
                <h1>Order by</h1>
                <pre class="sql"><code>SELECT Name
    , Year(Date) year
    , CASE WHEN Max([Maximum Wind]) > 110 THEN 'Major' ELSE 'Not Major' END major
FROM atlantic
GROUP BY Name, Year(Date)
ORDER BY year DESC, major, name ASC</code></pre>
            </section>
            <section>
                <h1>Union</h1>
                <pre class="sql"><code>SELECT Year(Date) year FROM atlantic
GROUP BY Year(Date) HAVING Max([Maximum Wind]) > 150
UNION
SELECT Year(Date) year FROM pacific
GROUP BY Year(Date) HAVING Max([Maximum Wind]) > 150</code></pre>
            </section>
            <section>
                <h1>Case</h1>
                <pre class="sql"><code>SELECT Year(Date) year, Name,
CASE
    WHEN MIN([Minimum Pressure]) < 950 THEN
      'Low'
    ELSE
      'Normal'
    END pressure
FROM atlantic
GROUP BY YEAR(Date), Name
ORDER BY year DESC
</code></pre>
            </section>
        </section>
        <section>
            <section>
                <h1>Logging in</h1>
            </section>
            <section data-background="img/slide_01.png"></section>
        </section>
        <section id="joins">
            <section>
                <h1>Joins</h1>
                <p>Used to join tables horizontally.</p>
            </section>
            <section>
                <h1>Sample Data</h1>
                <img src="img/slide_02.png">
            </section>
        </section>
        <section id="inner-join">
            <section>
                <h1>Inner Join</h1>
                <p>Used to get the results only in both tables</p>
                <img src="img/slide_03.png">
            </section>
            <section>
                <h1>Inner join</h1>
                <h2>Example</h2>
                <pre class="sql"><code>SELECT * FROM table_a A
INNER JOIN table_b B
ON A.name = B.name</code></pre>
            </section>
            <section>
                <h1>Inner Join</h1>
                <img src="img/slide_04.png">
            </section>
        </section>
        <section id="full-outer-join">
            <section>
                <h1>Full Outer Join</h1>
                <p>Used to get the results that exist in either side.</p>
                <img src="img/slide_05.png">
            </section>
            <section>
                <h1>Inner join</h1>
                <h2>Example</h2>
                <pre class="sql"><code>SELECT * FROM table_a A
FULL OUTER JOIN table_b B
ON A.name = B.name</code></pre>
            </section>
            <section>
                <h1>Inner Join</h1>
                <img src="img/slide_06.png">
            </section>
        </section>
        <section id="left-join">
            <section>
                <h1>Left Join</h1>
                <p>Used to get the results in the left table</p>
                <img src="img/slide_07.png">
            </section>
            <section>
                <h1>Left join</h1>
                <h2>Example</h2>
                <pre class="sql"><code>SELECT * FROM table_a A
LEFT OUTER JOIN table_b B
ON A.name = B.name</code></pre>
            </section>
            <section>
                <h1>Left Join</h1>
                <img src="img/slide_08.png">
            </section>
        </section>
        <section id="filtered-left-join">
            <section>
                <h1>Filtered Left Join</h1>
                <p>Used to get the results only in left table</p>
                <img src="img/slide_09.png">
            </section>
            <section>
                <h1>Filtered Left join</h1>
                <h2>Example</h2>
                <pre class="sql"><code>SELECT * FROM table_a A
LEFT OUTER JOIN table_b B
ON A.name = B.name
WHERE B.id IS null</code></pre>
            </section>
            <section>
                <h1>Filtered Left Join</h1>
                <img src="img/slide_10.png">
            </section>
        </section>
        <section id="right-join">
            <section>
                <h1>Right Join</h1>
                <p>Used to get the results in the right table</p>
                <img src="img/slide_13.png">
            </section>
            <section>
                <h1>Right join</h1>
                <h2>Example</h2>
                <pre class="sql"><code>SELECT * FROM table_a A
RighT OUTER JOIN table_b B
ON A.name = B.name</code></pre>
            </section>
            <section>
                <h1>RIght Join</h1>
                <img src="img/slide_14.png">
            </section>
        </section>
        <section id="filtered-right-join">
            <section>
                <h1>Filtered Right Join</h1>
                <p>Used to get the results only in right table</p>
                <img src="img/slide_15.png">
            </section>
            <section>
                <h1>Filtered Right join</h1>
                <h2>Example</h2>
                <pre class="sql"><code>SELECT * FROM table_a A
RIGHT OUTER JOIN table_b B
ON A.name = B.name
WHERE A.id IS null</code></pre>
            </section>
            <section>
                <h1>Filtered Right Join</h1>
                <img src="img/slide_16.png">
            </section>
        </section>
        <section id="filtered-full-outer-join">
            <section>
                <h1>Filtered Full OUter Join</h1>
                <p>Used to get the results only in one table</p>
                <img src="img/slide_11.png">
            </section>
            <section>
                <h1>Filtered Full Outer Join</h1>
                <h2>Example</h2>
                <pre class="sql"><code>SELECT * FROM table_a A
FULL OUTER JOIN table_b B
ON A.name = B.name
WHERE A.id IS null
OR B.id IS null</code></pre>
            </section>
            <section>
                <h1>Filtered Outer Join</h1>
                <img src="img/slide_12.png">
            </section>
        </section>
        <section id="cross-join">
            <section>
                <h1>Cross Join</h1>
                <p>Used to get every row in each table paired with every row in the other table.</p>
                <p>There is no good venn diagram analogy for this.</p>
            </section>
            <section>
                <h1>Cross join</h1>
                <h2>Example</h2>
                <pre class="sql"><code>SELECT * FROM table_a A
CROSS JOIN table_b B</code></pre>
            </section>
            <section>
                <h1>Cross Join</h1>
                <img src="img/slide_17.png">
            </section>
        </section>
        <section>
            <section>
                <h1>Exercise 1</h1>
            </section>
            <section>
                <p>Get the all the names ever used for storms in the atlantic with a maximum wind speed of over
                    100</p>
            </section>
            <section>
                <pre class="sql"><code>SELECT DISTINCT Name
FROM Atlantic WHERE [Maximum Wind] > 100</code></pre>
            </section>
        </section>
        <section>
            <section>
                <h1>Exercise 2</h1>
            </section>
            <section>
                <p>Find Name, Year and Maximum Wind speed of the 5 storms with the highest wind speed in the
                    pacific.</p>
            </section>
            <section>
                    <pre class="sql"><code>SELECT Top 5 Name, Year(Date), MAX([Maximum Wind]) max_wind
FROM pacific
GROUP BY Name, Year(Date)
ORDER BY max_wind DESC</code></pre>
            </section>
        </section>
        <section>
            <section>
                <h1>Exercise 3</h1>
            </section>
            <section>
                <p>Create a list of all the statuses of storms in either the atlantic of pacific ocean</p>
            </section>
            <section>
                <pre class="sql"><code>SELECT DISTINCT Status FROM atlantic
UNION
SELECT DISTINCT Status FROM pacific </code></pre>
            </section>
        </section>
        <section>
            <section>
                <h1>Exercise 4</h1>
            </section>
            <section>
                <p>Create a list of statuses that can appear in either the atlantic or pacific oceans</p>
            </section>
            <section>
                <pre class="sql"><code>SELECT DISTINCT Status FROM atlantic
INTERSECT
SELECT DISTINCT Status FROM pacific </code></pre>
            </section>
        </section>
        <section>
            <section>
                <h1>Exercise 5</h1>
            </section>
            <section>
                <p>Use an alias to select Name and Year from the atlantic table</p>
            </section>
            <section>
                <pre class="sql"><code>SELECT A.Name, Year(A.Date) year
FROM atlantic A</code></pre>
            </section>
        </section>
        <section>
            <section>
                <h1>Exercise 6</h1>
            </section>
            <section>
                <p>List all the storms and whether it is a major storm or not, ordered by year, whether it was major and then in alphabetical order.</p>
            </section>
            <section>
                <pre class="sql"><code>SELECT Name
    , Year(Date) year
    , CASE WHEN Max([Maximum Wind]) > 110 THEN 'Major' ELSE 'Not Major' END major
FROM atlantic
GROUP BY Name, Year(Date)
ORDER BY year DESC, major, name ASC</code></pre>
            </section>
        </section>
        <section>
            <section>
                <h1>Exercise 7</h1>
            </section>
            <section>
                <p>List all the storms and what category of storm it is, ordered by category descending, year and name</p>
                <ul>
                    <li>Cat 1 is 74 to 95</li>
                    <li>Cat 2 is 96 to 112</li>
                    <li>Cat 3 is 112 to 130</li>
                    <li>Cat 4 is 131 to 157</li>
                    <li>Cat 5 is 157 and upwards</li>
                </ul>
            </section>
            <section>
                <pre class="sql"><code>SELECT Name
    , YEAR(Date) year
    , CASE WHEN Max([Maximum Wind]) < 74 THEN 0 ELSE
          CASE WHEN Max([Maximum Wind]) < 96 THEN 1 ELSE
              CASE WHEN Max([Maximum Wind]) < 111 THEN 2 ELSE
                  CASE WHEN Max([Maximum Wind]) < 130 THEN 3 ELSE
                      CASE WHEN Max([Maximum Wind]) < 157 THEN 4 ELSE 5 END
                END
            END
        END
    END category
FROM atlantic
GROUP BY Name, YEAR(Date)
ORDER BY category DESC, year, Name ASC</code></pre>
            </section>
        </section>
        <section>
            <h1>Questions?</h1>
        </section>
    </div>
</div>

<script src="../../lib/js/head.min.js"></script>
<script src="../../js/reveal.js"></script>

<script>
    // More info about config & dependencies:
    // - https://github.com/hakimel/reveal.js#configuration
    // - https://github.com/hakimel/reveal.js#dependencies
    Reveal.initialize({
        dependencies: [
            {src: 'plugin/markdown/marked.js'},
            {src: 'plugin/markdown/markdown.js'},
            {src: 'plugin/notes/notes.js', async: true},
            {
                src: 'plugin/highlight/highlight.js', async: true, callback: function () {
                    hljs.initHighlightingOnLoad();
                }
            }
        ]
    });
</script>
</body>
</html>
